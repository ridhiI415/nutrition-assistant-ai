from flask import Flask, request, jsonify

app = Flask(__name__)

@app.route('/generate-meal-plan', methods=['POST'])
def generate_meal_plan():
    data = request.get_json()

    # Extract user input
    age = data.get('age', '25')
    gender = data.get('gender', 'female')
    goal = data.get('goal', 'weight loss')
    diet = data.get('diet', 'vegetarian')
    allergies = data.get('allergies', 'none')

    # Create AI-style prompt (mock for now)
    prompt = (
        f"Create a 1-day {diet} meal plan for a {age}-year-old {gender} "
        f"with a goal of {goal}. Exclude ingredients related to {allergies}."
    )

    # (Mocked) Replace this with actual call to Watsonx.ai later
    meal_plan = {
        "breakfast": "Oats with almond milk and fruits",
        "lunch": "Quinoa salad with chickpeas and veggies",
        "snack": "Roasted chana and green tea",
        "dinner": "Lentil soup with saut√©ed greens and brown rice"
    }

    response = {
        "input_summary": {
            "age": age,
            "gender": gender,
            "goal": goal,
            "diet": diet,
            "allergies": allergies
        },
        "prompt_used": prompt,
        "generated_meal_plan": meal_plan
    }

    return jsonify(response)

if __name__ == '__main__':
    app.run(debug=True)
